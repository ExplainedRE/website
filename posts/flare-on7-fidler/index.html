<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>Flare-On 7 — 01 Fidler - explained.re</title><meta name=Description content><meta property="og:title" content="Flare-On 7 — 01 Fidler"><meta property="og:description" content="Challenge Description  Welcome to the Seventh Flare-On Challenge!
This is a simple game. Win it by any means necessary and the victory screen will reveal the flag. Enter the flag here on this site to score and move on to the next level.
This challenge is written in Python and is distributed as a runnable EXE and matching source code for your convenience. You can run the source code directly on any Python platform with PyGame if you would prefer."><meta property="og:type" content="article"><meta property="og:url" content="https://explained.re/posts/flare-on7-fidler/"><meta property="og:image" content="https://explained.re/images/explained_dark.png"><meta property="article:published_time" content="2020-10-23T21:29:41+03:00"><meta property="article:modified_time" content="2020-10-23T21:29:41+03:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://explained.re/images/explained_dark.png"><meta name=twitter:title content="Flare-On 7 — 01 Fidler"><meta name=twitter:description content="Challenge Description  Welcome to the Seventh Flare-On Challenge!
This is a simple game. Win it by any means necessary and the victory screen will reveal the flag. Enter the flag here on this site to score and move on to the next level.
This challenge is written in Python and is distributed as a runnable EXE and matching source code for your convenience. You can run the source code directly on any Python platform with PyGame if you would prefer."><meta name=application-name content="explained.re"><meta name=apple-mobile-web-app-title content="explained.re"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://explained.re/posts/flare-on7-fidler/><link rel=next href=https://explained.re/posts/flare-on7-garbage/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Flare-On 7 — 01 Fidler","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/explained.re\/posts\/flare-on7-fidler\/"},"genre":"posts","keywords":"flare-on","wordcount":576,"url":"https:\/\/explained.re\/posts\/flare-on7-fidler\/","datePublished":"2020-10-23T21:29:41+03:00","dateModified":"2020-10-23T21:29:41+03:00","publisher":{"@type":"Organization","name":"explained.re"},"author":{"@type":"Person","name":"explained.re"},"description":""}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem('theme')?localStorage.getItem('theme')==='dark':('dark'==='auto'?window.matchMedia('(prefers-color-scheme: dark)').matches:'dark'==='dark'))&&document.body.setAttribute('theme','dark');</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title=explained.re><img class="lazyload logo" src=/svg/loading.min.svg data-src=/images/explained.svg data-srcset="/images/explained.svg, /images/explained.svg 1.5x, /images/explained.svg 2x" data-sizes=auto alt=/images/explained.svg title=/images/explained.svg></a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><a class=menu-item href=/about/>About </a><a class=menu-item href=https://github.com/explainedre/website title=GitHub rel="noopener noreffer" target=_blank><i class="fab fa-github fa-fw"></i></a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=explained.re><img class="lazyload logo" src=/svg/loading.min.svg data-src=/images/explained.svg data-srcset="/images/explained.svg, /images/explained.svg 1.5x, /images/explained.svg 2x" data-sizes=auto alt=/images/explained.svg title=/images/explained.svg></a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/posts/>Posts</a><a class=menu-item href=/tags/>Tags</a><a class=menu-item href=/categories/>Categories</a><a class=menu-item href=/about/>About</a><a class=menu-item href=https://github.com/explainedre/website title=GitHub rel="noopener noreffer" target=_blank><i class="fab fa-github fa-fw"></i></a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><article class="page single"><h1 class="single-title animated flipInX">Flare-On 7 — 01 Fidler</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw"></i>explained.re</a></span>&nbsp;<span class=post-category>included in <a href=/categories/write-up/><i class="far fa-folder fa-fw"></i>write-up</a>&nbsp;<a href=/categories/ctf/><i class="far fa-folder fa-fw"></i>ctf</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2020-10-23>2020-10-23</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;576 words&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;3 minutes&nbsp;</div></div><div class=content id=content><div class="details admonition info open"><div class="details-summary admonition-title"><i class="icon fas fa-info-circle fa-fw"></i>Challenge Description<i class="details-icon fas fa-angle-right fa-fw"></i></div><div class=details-content><div class=admonition-content><p>Welcome to the Seventh Flare-On Challenge!</p><p>This is a simple game. Win it by any means necessary and the victory screen will reveal the flag. Enter the flag here on this site to score and move on to the next level.</p><p>This challenge is written in Python and is distributed as a runnable EXE and matching source code for your convenience. You can run the source code directly on any Python platform with PyGame if you would prefer.</p></div></div></div><p>In this first challenge, we get a Python program that was distributed as a Windows executable. The challenge author was kind enough to provide the executable alongside the source code that was used to create it. Running the executable we get this window.</p><a class=lightgallery href=/posts/flare-on7-fidler/images/image.png title=/posts/flare-on7-fidler/images/image.png data-thumbnail=/posts/flare-on7-fidler/images/image.png><img class=lazyload src=/svg/loading.min.svg data-src=images/image.png data-srcset="/posts/flare-on7-fidler/images/image.png, images/image.png 1.5x, /posts/flare-on7-fidler/images/image.png 2x" data-sizes=auto alt=/posts/flare-on7-fidler/images/image.png></a><p>This is a simple prompt for a password. Let&rsquo;s dig into the Python source code to try and get it. After looking at as little as 9 lines of code, we stumble across a function called <code>password_check</code>.</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=k>def</span> <span class=nf>password_check</span><span class=p>(</span><span class=nb>input</span><span class=p>):</span>
    <span class=n>altered_key</span> <span class=o>=</span> <span class=s1>&#39;hiptu&#39;</span>
    <span class=n>key</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>([</span><span class=nb>chr</span><span class=p>(</span><span class=nb>ord</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>altered_key</span><span class=p>])</span>
    <span class=k>return</span> <span class=nb>input</span> <span class=o>==</span> <span class=n>key</span>
</code></pre></div><p>Looks like each character of <code>'hiptu'</code> is subtracted by 1, and then compared to our password. We&rsquo;ll execute this process to get the correct password.</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>([</span><span class=nb>chr</span><span class=p>(</span><span class=nb>ord</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=s1>&#39;hiptu&#39;</span><span class=p>])</span>

<span class=c1># Results:</span>
<span class=c1># &#39;ghost&#39;</span>
</code></pre></div><p>After we insert the <code>ghost</code>, we see the following window (keeping up with the cats theme in the first challenge):</p><a class=lightgallery href=/posts/flare-on7-fidler/images/image_1.png title=/posts/flare-on7-fidler/images/image_1.png data-thumbnail=/posts/flare-on7-fidler/images/image_1.png><img class=lazyload src=/svg/loading.min.svg data-src=images/image_1.png data-srcset="/posts/flare-on7-fidler/images/image_1.png, images/image_1.png 1.5x, /posts/flare-on7-fidler/images/image_1.png 2x" data-sizes=auto alt=/posts/flare-on7-fidler/images/image_1.png></a><p>Seems like we need to earn 100 Billion coins to get the flag, but 100 Billion does sound like a lot. After all, we have 10 more challenges to solve, so we better try to find the flag in the source code.</p><p>Browsing through the code, we see a function called <code>decode_flag</code>. This must be important. Let&rsquo;s see where it is being used.</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=k>def</span> <span class=nf>victory_screen</span><span class=p>(</span><span class=n>token</span><span class=p>):</span>
	<span class=p>[</span> <span class=o>.</span> <span class=o>.</span> <span class=o>.</span> <span class=p>]</span>
	<span class=n>flag_content_label</span><span class=o>.</span><span class=n>change_text</span><span class=p>(</span><span class=n>decode_flag</span><span class=p>(</span><span class=o>**</span><span class=n>token</span><span class=o>**</span><span class=p>))</span>
	<span class=p>[</span> <span class=o>.</span> <span class=o>.</span> <span class=o>.</span> <span class=p>]</span>
</code></pre></div><p><code>decode_flag</code> is called in <code>victory_screen</code> and it gets an argument called <code>token</code>, which is the parameter of the <code>victory_screen</code> function. We have to go a step back and see how <code>victory_screen</code> is invoked.</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=k>def</span> <span class=nf>game_screen</span><span class=p>():</span>
	<span class=p>[</span> <span class=o>.</span> <span class=o>.</span> <span class=o>.</span> <span class=p>]</span> 
	<span class=n>target_amount</span> <span class=o>=</span> <span class=p>(</span><span class=mi>2</span><span class=o>**</span><span class=mi>36</span><span class=p>)</span> <span class=o>+</span> <span class=p>(</span><span class=mi>2</span><span class=o>**</span><span class=mi>35</span><span class=p>)</span>
	<span class=k>if</span> <span class=n>current_coins</span> <span class=o>&gt;</span> <span class=p>(</span><span class=n>target_amount</span> <span class=o>-</span> <span class=mi>2</span><span class=o>**</span><span class=mi>20</span><span class=p>):</span>
	    <span class=k>while</span> <span class=n>current_coins</span> <span class=o>&gt;=</span> <span class=p>(</span><span class=n>target_amount</span> <span class=o>+</span> <span class=mi>2</span><span class=o>**</span><span class=mi>20</span><span class=p>):</span>
	        <span class=n>current_coins</span> <span class=o>-=</span> <span class=mi>2</span><span class=o>**</span><span class=mi>20</span>
	    <span class=n>victory_screen</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>current_coins</span> <span class=o>/</span> <span class=mi>10</span><span class=o>**</span><span class=mi>8</span><span class=p>))</span>
	    <span class=k>return</span>
</code></pre></div><p>We see that it is being invoked by <code>game_screen</code>, and that it gets the number of coins we have currently, divided by <code>10**8</code>(100 million). In the game screen itself, we saw that we need to have 100 Billion (<code>10**11</code>) coins in order to get the flag, so let&rsquo;s use this number as our amount of coins, and call <code>decode_flag</code> ourselves, outside of the context of the game and simulate winning conditions.</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=n>current_coins</span> <span class=o>=</span> <span class=mi>10</span><span class=o>**</span><span class=mi>12</span> <span class=c1># More than about 100 Billion target</span>
<span class=n>target_amount</span> <span class=o>=</span> <span class=p>(</span><span class=mi>2</span><span class=o>**</span><span class=mi>36</span><span class=p>)</span> <span class=o>+</span> <span class=p>(</span><span class=mi>2</span><span class=o>**</span><span class=mi>35</span><span class=p>)</span>
<span class=k>if</span> <span class=n>current_coins</span> <span class=o>&gt;</span> <span class=p>(</span><span class=n>target_amount</span> <span class=o>-</span> <span class=mi>2</span><span class=o>**</span><span class=mi>20</span><span class=p>):</span>
    <span class=k>while</span> <span class=n>current_coins</span> <span class=o>&gt;=</span> <span class=p>(</span><span class=n>target_amount</span> <span class=o>+</span> <span class=mi>2</span><span class=o>**</span><span class=mi>20</span><span class=p>):</span>
        <span class=n>current_coins</span> <span class=o>-=</span> <span class=mi>2</span><span class=o>**</span><span class=mi>20</span>
    <span class=k>print</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>current_coins</span> <span class=o>/</span> <span class=mi>10</span><span class=o>**</span><span class=mi>8</span><span class=p>))</span>
<span class=c1># Result:</span>
<span class=c1># 1030</span>
</code></pre></div><p>We got <code>1030</code>. Now let&rsquo;s use this as the token for the <code>decode_flag</code> function and see what we get.</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=k>def</span> <span class=nf>decode_flag</span><span class=p>(</span><span class=n>frob</span><span class=p>):</span>
    <span class=n>last_value</span> <span class=o>=</span> <span class=n>frob</span>
    <span class=n>encoded_flag</span> <span class=o>=</span> <span class=p>[</span><span class=mi>1135</span><span class=p>,</span> <span class=mi>1038</span><span class=p>,</span> <span class=mi>1126</span><span class=p>,</span> <span class=mi>1028</span><span class=p>,</span> <span class=mi>1117</span><span class=p>,</span> <span class=mi>1071</span><span class=p>,</span> <span class=mi>1094</span><span class=p>,</span> <span class=mi>1077</span><span class=p>,</span> <span class=mi>1121</span><span class=p>,</span> <span class=mi>1087</span><span class=p>,</span> <span class=mi>1110</span><span class=p>,</span> <span class=mi>1092</span><span class=p>,</span> <span class=mi>1072</span><span class=p>,</span> <span class=mi>1095</span><span class=p>,</span> <span class=mi>1090</span><span class=p>,</span> <span class=mi>1027</span><span class=p>,</span>
                    <span class=mi>1127</span><span class=p>,</span> <span class=mi>1040</span><span class=p>,</span> <span class=mi>1137</span><span class=p>,</span> <span class=mi>1030</span><span class=p>,</span> <span class=mi>1127</span><span class=p>,</span> <span class=mi>1099</span><span class=p>,</span> <span class=mi>1062</span><span class=p>,</span> <span class=mi>1101</span><span class=p>,</span> <span class=mi>1123</span><span class=p>,</span> <span class=mi>1027</span><span class=p>,</span> <span class=mi>1136</span><span class=p>,</span> <span class=mi>1054</span><span class=p>]</span>
    <span class=n>decoded_flag</span> <span class=o>=</span> <span class=p>[]</span>

    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>encoded_flag</span><span class=p>)):</span>
        <span class=n>c</span> <span class=o>=</span> <span class=n>encoded_flag</span><span class=p>[</span><span class=n>i</span><span class=p>]</span>
        <span class=n>val</span> <span class=o>=</span> <span class=p>(</span><span class=n>c</span> <span class=o>-</span> <span class=p>((</span><span class=n>i</span><span class=o>%</span><span class=mi>2</span><span class=p>)</span><span class=o>*</span><span class=mi>1</span> <span class=o>+</span> <span class=p>(</span><span class=n>i</span><span class=o>%</span><span class=mi>3</span><span class=p>)</span><span class=o>*</span><span class=mi>2</span><span class=p>))</span> <span class=o>^</span> <span class=n>last_value</span>
        <span class=n>decoded_flag</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>val</span><span class=p>)</span>
        <span class=n>last_value</span> <span class=o>=</span> <span class=n>c</span>

    <span class=k>return</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>([</span><span class=nb>chr</span><span class=p>(</span><span class=n>x</span><span class=p>)</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>decoded_flag</span><span class=p>])</span>

<span class=k>print</span><span class=p>(</span><span class=n>decode_flag</span><span class=p>(</span><span class=mi>1030</span><span class=p>))</span>
<span class=c1># Result:</span>
<span class=c1># idle_with_kitty@flare-on.com</span>
</code></pre></div><p>We got the flag - <a href=mailto:idle_with_kitty@flare-on.com rel><code>idle_with_kitty@flare-on.com</code></a>.</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2020-10-23</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/flare-on/>flare-on</a></section><section><span><a href=javascript:void(0); onclick=window.history.back();>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/flare-on7-garbage/ class=next rel=next title="Flare-On 7 — 02 Garbage">Flare-On 7 — 02 Garbage<i class="fas fa-angle-right fa-fw"></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.77.0">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i>LoveIt</a></div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2020</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank></a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw"></i></a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw"></i></a></div><link rel=stylesheet href=/lib/lightgallery/lightgallery.min.css><script type=text/javascript src=/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/lightgallery/lightgallery.min.js></script><script type=text/javascript src=/lib/lightgallery/lg-thumbnail.min.js></script><script type=text/javascript src=/lib/lightgallery/lg-zoom.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript>window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":60},"comment":{},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true}};</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js',new Date());gtag('config','G-Z0NYXY577C');</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=G-Z0NYXY577C" async></script></body></html>